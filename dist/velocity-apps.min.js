/**
 * Velocity Apps - v1.0.0-alpha1 - 2019-04-05
 * Description: Velocity Apps is application and controllers library for CMSGears.
 * License: GPL-3.0-or-later
 * Author: Bhagwat Singh Chouhan
 */


var cmg;function setUserData(e,t){cmt.utils.ajax.triggerPost(ajaxUrl+"user/set-data","Meta[key]="+e+"&Meta[value]="+t)}function removeUserData(e){cmt.utils.ajax.triggerPost(ajaxUrl+"user/remove-data","Meta[key]="+e)}function setUserAttribute(e,t){cmt.utils.ajax.triggerPost(ajaxUrl+"user/set-attribute","Meta[key]="+e+"&Meta[value]="+t)}function removeUserAttribute(e){cmt.utils.ajax.triggerPost(ajaxUrl+"user/remove-attribute","Meta[key]="+e)}function setUserConfig(e,t){cmt.utils.ajax.triggerPost(ajaxUrl+"user/set-config","Meta[key]="+e+"&Meta[value]="+t)}function removeUserConfig(e){cmt.utils.ajax.triggerPost(ajaxUrl+"user/remove-config","Meta[key]="+e)}function setUserSetting(e,t){cmt.utils.ajax.triggerPost(ajaxUrl+"user/set-setting","Meta[key]="+e+"&Meta[value]="+t)}function removeUserSetting(e){cmt.utils.ajax.triggerPost(ajaxUrl+"user/remove-setting","Meta[key]="+e)}function initLazyWidgetObserver(){var e=[].slice.call(document.querySelectorAll(".cmt-lazy-widget"));"IntersectionObserver"in window?(intersectionObserver=new IntersectionObserver(function(e,t){e.forEach(function(e){(0<e.intersectionRatio||e.isIntersecting)&&(target=e.target,processLazyWidget(target),t.unobserve(target))})}),e.forEach(function(e){intersectionObserver.observe(e)})):initLazyWidgetListener(e)}function initLazyWidgetListener(e){var t=!1,r=function(){!1===t&&(t=!0,setTimeout(function(){e.forEach(function(t){t.getBoundingClientRect().top<=window.innerHeight&&0<=t.getBoundingClientRect().bottom&&"none"!==getComputedStyle(t).display&&(processLazyWidget(t),0===(e=e.filter(function(e){return t!==e})).length&&(document.removeEventListener("scroll",r),window.removeEventListener("resize",r),window.removeEventListener("orientationchange",r)))}),t=!1},200))};document.addEventListener("scroll",r),window.addEventListener("resize",r),window.addEventListener("orientationchange",r)}function processLazyWidget(e){cmt.api.utils.request.trigger(cmt.api.root.getApplication("autoload"),e,!1,e.find(".cmt-click"))}jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("core","cmt.api.Application",{basePath:ajaxUrl});cmt.api.utils.request.register(e,jQuery("[cmt-app=core]"))}),(cmg=cmg||{}).core=cmg.core||{},cmg.core.controllers=cmg.core.controllers||{},cmg.core.services=cmg.core.services||{},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("address","cmg.core.controllers.AddressController")}),cmg.core.controllers.AddressController=function(){this.app=cmt.api.root.getApplication("core"),this.modelService=this.app.getService("address")},cmg.core.controllers.AddressController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.AddressController.prototype.getActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-address");e.closest(".actions-list-data").slideUp("fast"),this.modelService.initUpdateForm(r,o,t.data)},cmg.core.controllers.AddressController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e);this.modelService.add(r,t.data)},cmg.core.controllers.AddressController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-address[data-id="+t.data.cid+"]");this.modelService.refresh(r,o,t.data)},cmg.core.controllers.AddressController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-address[data-id="+t.data.cid+"]");e.closest(".actions-list-data").slideUp("fast"),this.modelService.remove(r,o)},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("city","cmg.core.controllers.CityController")}),cmg.core.controllers.CityController=function(){},cmg.core.controllers.CityController.inherits(cmt.api.controllers.BaseController),cmg.core.controllers.CityController.prototype.autoSearchActionPre=function(e){var t=e.closest(".cmt-location"),r=e.closest(".auto-fill"),o=t.find(".cmt-location-province").val(),i=t.find(".cmt-location-region").val(),c=t.find(".auto-fill-text").val();return c.length<=0?(r.find(".auto-fill-items").slideUp(),r.find(".target").val(""),!1):(this.requestData="province-id="+o+"&region-id="+i+"&name="+c,!0)},cmg.core.controllers.CityController.prototype.autoSearchActionSuccess=function(l,e){var t=e.data,r="",s=l.closest(".auto-fill"),m=s.find(".auto-fill-items");for(i=0;i<t.length;i++){var o=t[i];r+='<li class="auto-fill-item" data-id="'+o.id+'" data-lat="'+o.latitude+'" data-lon="'+o.longitude+'" data-zip="'+o.postal+'">'+o.name+"</li>"}0==r.length?(r='<li class="auto-fill-message">No matching results found.</li>',m.html(r)):(m.html(r),l.find(".auto-fill-item").click(function(){var e=s.find(".target"),t=jQuery(this).attr("data-id"),r=jQuery(this).html(),o=jQuery(this).attr("data-lat"),i=jQuery(this).attr("data-lon"),c=jQuery(this).attr("data-zip");c=c.split(" "),m.slideUp(),e.val(t),l.find(".auto-fill-text").val(r);var a=jQuery(this).closest(".cmt-location"),n=o+","+i;a.find(".search-ll").val(n).trigger("change"),a.find(".address-zip").val(c[0])})),m.slideDown()},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapController("comment","cmg.core.controllers.CommentController"),e.mapController("review","cmg.core.controllers.ReviewController"),e.mapController("feedback","cmg.core.controllers.FeedbackController")}),cmg.core.controllers.CommentController=function(){},cmg.core.controllers.CommentController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.CommentController.prototype.createActionSuccess=function(e,t){e.find(".cmt-rating").cmtRate("reset")},cmg.core.controllers.ReviewController=function(){},cmg.core.controllers.ReviewController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.ReviewController.prototype.createActionSuccess=function(e,t){e.find(".gallery-review").html(""),e.find(".cmt-rating").cmtRate("reset")},cmg.core.controllers.FeedbackController=function(){},cmg.core.controllers.FeedbackController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.FeedbackController.prototype.createActionSuccess=function(e,t){e.find(".gallery-feedback").html(""),e.find(".cmt-rating").cmtRate("reset")},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("file","cmg.core.controllers.FileController")}),cmg.core.controllers.FileController=function(){this.app=cmt.api.root.getApplication("core"),this.modelService=this.app.getService("file")},cmg.core.controllers.FileController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.FileController.prototype.assignActionSuccess=function(e,t){e.closest(".cmt-file-uploader").find(".post-action").hide()},cmg.core.controllers.FileController.prototype.clearActionPre=function(e){var t=e.closest(".cmt-file-uploader"),r=t.find(".id");return 0<r.length&&0<r.val().length&&0<parseInt(r.val())||(this.modelService.clear(t),!1)},cmg.core.controllers.FileController.prototype.clearActionSuccess=function(e,t){var r=e.closest(".cmt-file-uploader");this.modelService.clear(r)},cmg.core.controllers.FileController.prototype.clearActionFailure=function(e,t){var r=e.closest(".cmt-file-uploader");this.modelService.clear(r)},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("location","cmg.core.controllers.LocationController")}),cmg.core.controllers.LocationController=function(){this.app=cmt.api.root.getApplication("core"),this.modelService=this.app.getService("location")},cmg.core.controllers.LocationController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.LocationController.prototype.getActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-location");e.closest(".actions-list-data").slideUp("fast"),this.modelService.initUpdateForm(r,o,t.data)},cmg.core.controllers.LocationController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e);this.modelService.add(r,t.data)},cmg.core.controllers.LocationController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-location[data-id="+t.data.cid+"]");this.modelService.refresh(r,o,t.data)},cmg.core.controllers.LocationController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-location[data-id="+t.data.cid+"]");e.closest(".actions-list-data").slideUp("fast"),this.modelService.remove(r,o)},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("main","cmg.core.controllers.MainController")}),cmg.core.controllers.MainController=function(){},cmg.core.controllers.MainController.inherits(cmt.api.controllers.RequestController),jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("meta","cmg.core.controllers.MetaController")}),cmg.core.controllers.MetaController=function(){this.app=cmt.api.root.getApplication("core"),this.modelService=this.app.getService("meta")},cmg.core.controllers.MetaController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.AddressController.prototype.getActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-meta");e.closest(".actions-list-data").slideUp("fast"),this.modelService.initUpdateForm(r,o,t.data)},cmg.core.controllers.MetaController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e);this.modelService.add(r,t.data)},cmg.core.controllers.MetaController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-meta[data-id="+t.data.id+"]");this.modelService.refresh(r,o,t.data)},cmg.core.controllers.MetaController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-meta[data-id="+t.data.id+"]");e.closest(".actions-list-data").slideUp("fast"),this.modelService.remove(r,o)},cmg.core.controllers.AddressController.prototype.toggleActionSuccess=function(e,t){},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("model","cmg.core.controllers.ModelController")}),cmg.core.controllers.ModelController=function(){this.app=cmt.api.root.getApplication("core"),this.modelService=this.app.getService("model")},cmg.core.controllers.ModelController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.ModelController.prototype.getActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-model");e.closest(".actions-list-data").slideUp("fast"),this.modelService.initUpdateForm(r,o,t.data)},cmg.core.controllers.ModelController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e);this.modelService.add(r,t.data)},cmg.core.controllers.ModelController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-model[data-id="+t.data.id+"]");this.modelService.refresh(r,o,t.data)},cmg.core.controllers.ModelController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-model[data-id="+t.data.id+"]");e.closest(".actions-list-data").slideUp("fast"),this.modelService.remove(r,o)},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("province","cmg.core.controllers.ProvinceController"),jQuery(".cmt-location-province").change(function(){var e=jQuery(this).closest(".cmt-location").find(".cmt-location-city-fill");e.find(".target").val(""),e.find(".auto-fill-text").val("")})}),cmg.core.controllers.ProvinceController=function(){},cmg.core.controllers.ProvinceController.inherits(cmt.api.controllers.BaseController),cmg.core.controllers.ProvinceController.prototype.optionsListActionPre=function(e){var t=e.find("select");return this.requestData="country-id="+t.val(),cmt.utils.data.hasAttribute(t,"data-province")&&(this.requestData+="&province-id="+t.attr("data-province")),!0},cmg.core.controllers.ProvinceController.prototype.optionsListActionSuccess=function(e,t){var r=e.closest(".cmt-location").find(".cmt-location-provinces .cmt-select-wrap");jQuery.fn.cmtSelect.resetSelect(r,t.data)},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("region","cmg.core.controllers.RegionController"),jQuery(".cmt-location-region").change(function(){var e=jQuery(this).closest(".cmt-location").find(".cmt-location-city-fill");e.find(".target").val(""),e.find(".auto-fill-text").val("")})}),cmg.core.controllers.RegionController=function(){},cmg.core.controllers.RegionController.inherits(cmt.api.controllers.BaseController),cmg.core.controllers.RegionController.prototype.optionsListActionPre=function(e){var t=e.find("select");return this.requestData="province-id="+t.val(),cmt.utils.data.hasAttribute(t,"data-region")&&(this.requestData+="&region-id="+t.attr("data-region")),!0},cmg.core.controllers.RegionController.prototype.optionsListActionSuccess=function(e,t){var r=e.closest(".cmt-location").find(".cmt-location-regions .cmt-select-wrap");jQuery.fn.cmtSelect.resetSelect(r,t.data)},jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("site","cmg.core.controllers.SiteController")}),cmg.core.controllers.SiteController=function(){},cmg.core.controllers.SiteController.inherits(cmt.api.controllers.RequestController),jQuery(document).ready(function(){cmt.api.root.getApplication("core").mapController("user","cmg.core.controllers.UserController")}),cmg.core.controllers.UserController=function(){},cmg.core.controllers.UserController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.UserController.prototype.assignAvatarActionSuccess=function(e,t){var r=e.closest(".file-uploader");jQuery(".popout-group-main .wrap-user .fa-user").remove(),jQuery(".popout-group-main .wrap-user .user-avatar").remove(),jQuery(".popout-group-main .wrap-user").prepend('<img class="user-avatar" src="'+t.data.thumbUrl+'" />'),r.find(".post-action").hide()},cmg.core.controllers.UserController.prototype.clearAvatarActionSuccess=function(e,t){var r=e.closest(".file-uploader");jQuery(".popout-group-main .wrap-user .fa-user").remove(),jQuery(".popout-group-main .wrap-user .user-avatar").remove(),jQuery(".popout-group-main .wrap-user").prepend('<span class="fa fa-user icon"></span>'),r.find(".file-wrap .file-data").html('<i class="cmti cmti-5x cmti-user"></i>'),r.find(".file-clear").hide(),r.find(".post-action").hide()},cmg.core.controllers.UserController.prototype.profileActionSuccess=function(e,t){},cmg.core.controllers.UserController.prototype.accountActionSuccess=function(e,t){e.find(".data-crud-wrap .hidden-easy").removeClass("hidden-easy")},cmg.core.controllers.UserController.prototype.addressActionSuccess=function(e,t){},cmg.core.controllers.UserController.prototype.settingsActionSuccess=function(e,t){},cmg.core.controllers.UserController.prototype.autoSearchActionPre=function(e){var t=e.closest(".auto-fill"),r=t.find(".search-name").val(),o=t.find(".search-type");return r.length<=0?(t.find(".auto-fill-items").slideUp(),t.find(".auto-fill-target .target").val(""),!1):(1==o.length?this.requestData="name="+r+"&type="+o.val():this.requestData="name="+r,!0)},cmg.core.controllers.UserController.prototype.autoSearchActionSuccess=function(o,e){var t=e.data,r="",c=o.find(".auto-fill-items");for(i=0;i<t.length;i++){var a=t[i];r+='<li class="auto-fill-item" data-id="'+a.id+'">'+a.name+", "+a.email+"</li>"}0==r.length?(r="<li class='auto-fill-message'>No matching results found.</li>",c.html(r)):(c.html(r),o.find(".auto-fill-item").click(function(){var e=o.closest(".auto-fill").find(".auto-fill-target"),t=jQuery(this).attr("data-id"),r=(jQuery(this).attr("data-name"),jQuery(this).attr("data-email"),jQuery(this).html());c.slideUp(),e.find(".target").val(t),o.find(".auto-fill-text").val(r)})),c.slideDown()},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapService("address","cmg.core.services.AddressService"),e.getService("address").initListeners(),e.getService("address").refreshGoogleMap(jQuery(".frm-address"))}),cmg.core.services.AddressService=function(){this.addTemplate="addAddressTemplate",this.updateTemplate="updateAddressTemplate",this.viewTemplate="addressViewTemplate",this.refreshTemplate="addressRefreshTemplate"},cmg.core.services.AddressService.inherits(cmt.api.services.BaseService),cmg.core.services.AddressService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-address-add");0!=e.length&&e.click(function(){var e=jQuery(this).closest(".cmt-address-crud");t.initAddForm(e)})},cmg.core.services.AddressService.prototype.initAddForm=function(e){var t=document.getElementById(this.addTemplate).innerHTML,r=Handlebars.compile(t)({}),o=e.find(".cmt-address-form");o.hide(),o.html(r),cmt.api.utils.request.registerTargetApp("core",o),cmt.utils.ui.initSelectElement(o.find(".cmt-select")),o.find(".cmt-address-close").click(function(){o.fadeOut("fast")}),this.refreshGoogleMap(o),this.clearCity(o),o.fadeIn("slow")},cmg.core.services.AddressService.prototype.initUpdateForm=function(e,t,r){var o=document.getElementById(this.updateTemplate).innerHTML,i=Handlebars.compile(o)(r),c=e.find(".cmt-address-form");c.hide(),c.html(i),cmt.api.utils.request.registerTargetApp("core",c);var a=c.find(".cmt-location-country"),n=c.find(".cmt-location-province"),l=c.find(".cmt-location-region");a.val(a.attr("cid")),n.val(n.attr("pid")),1===l.length&&l.val(l.attr("rid")),c.find(".cmt-address-type").val(r.ctype),cmt.utils.ui.initSelectElement(c.find(".cmt-select")),c.find(".cmt-address-close").click(function(){c.fadeOut("fast")}),this.refreshGoogleMap(c),this.clearCity(c),c.fadeIn("slow"),this.refreshProvinces(c,n.attr("pid")),this.refreshRegions(c,l.attr("rid"))},cmg.core.services.AddressService.prototype.add=function(e,t){var r=document.getElementById(this.viewTemplate).innerHTML,o=Handlebars.compile(r)(t),i=e.find(".cmt-address-collection");i.prepend(o);var c=i.find(".cmt-address").first();cmt.api.utils.request.registerTargetApp("core",c),cmt.utils.ui.initActionsElement(c.find(".cmt-actions")),e.find(".cmt-address-form").slideUp("slow")},cmg.core.services.AddressService.prototype.refresh=function(e,t,r){var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.find(".cmt-address-header .title").html(r.title),t.find(".cmt-address-data").replaceWith(i),e.find(".cmt-address-form").slideUp("slow")},cmg.core.services.AddressService.prototype.remove=function(e,t){var r=t.find(".cmt-actions");if(0<r.length){var o=r.attr("ldata-id");jQuery("#actions-list-data-"+o).remove()}t.remove()},cmg.core.services.AddressService.prototype.findContainer=function(e){var t=e.closest(".cmt-address-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-address-crud")}}return t},cmg.core.services.AddressService.prototype.refreshProvinces=function(e,t){e.find(".cmt-location-country").attr("data-province",t),e.find(".cmt-location-country").closest(".cmt-location-countries").find(".cmt-click").trigger("click")},cmg.core.services.AddressService.prototype.refreshRegions=function(e,t){e.find(".cmt-location-province").attr("data-region",t),e.find(".cmt-location-province").closest(".cmt-location-provinces").find(".cmt-click").trigger("click")},cmg.core.services.AddressService.prototype.clearCity=function(e){e.find(".cmt-location-province, .cmt-location-region").change(function(){var e=jQuery(this).closest(".cmt-location").find(".cmt-location-city-fill");e.find(".target").val(""),e.find(".auto-fill-text").val("")})},cmg.core.services.AddressService.prototype.refreshGoogleMap=function(e){jQuery(e).find(".lat-long-picker").latLongPicker(),jQuery(e).find(".cmt-location-ll-picker .line1, .cmt-location-ll-picker .line2, .cmt-location-ll-picker .line3, .cmt-location-ll-picker .city, .cmt-location-ll-picker .zip").keyup(function(){var e=jQuery(".cmt-location-ll-picker .line1").val()+","+jQuery(".cmt-location-ll-picker .line2").val()+","+jQuery(".cmt-location-ll-picker .city").val()+","+jQuery(".cmt-location-ll-picker .zip").val();10<e.length&&jQuery(".cmt-location-ll-picker .search-box").val(e).trigger("change")})},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapService("file","cmg.core.services.FileService"),e.getService("file").initListeners()}),cmg.core.services.FileService=function(){},cmg.core.services.FileService.inherits(cmt.api.services.BaseService),cmg.core.services.FileService.prototype.initListeners=function(){},cmg.core.services.FileService.prototype.findContainer=function(e){var t=e.closest(".cmt-file-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-file-crud")}}return t},cmg.core.services.FileService.prototype.clear=function(e){var t=e.attr("type");switch(t="avatar"==e.attr("directory")?"avatar":t){case"avatar":e.find(".file-wrap .file-data").html('<i class="cmti cmti-5x cmti-user"></i>');break;case"image":e.find(".file-wrap .file-data").html('<i class="cmti cmti-5x cmti-image"></i>');break;case"video":e.find(".file-wrap .file-data").html('<i class="cmti cmti-5x cmti-file-video"></i>');break;case"compressed":e.find(".file-wrap .file-data").html('<i class="cmti cmti-5x cmti-file-archive"></i>');break;default:e.find(".file-wrap .file-data").html('<i class="icon cmti cmti-5x cmti-file"></i>')}e.find(".id").val(""),e.find(".change").val(""),e.find(".name").val(""),e.find(".file-clear").hide(),e.find(".post-action").hide()},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapService("location","cmg.core.services.LocationService"),e.getService("location").initListeners(),e.getService("location").refreshGoogleMap(jQuery(".frm-location"))}),cmg.core.services.LocationService=function(){this.addTemplate="addLocationTemplate",this.updateTemplate="updateLocationTemplate",this.viewTemplate="locationViewTemplate",this.refreshTemplate="locationRefreshTemplate"},cmg.core.services.LocationService.inherits(cmt.api.services.BaseService),cmg.core.services.LocationService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-location-add");0!=e.length&&e.click(function(){var e=jQuery(this).closest(".cmt-location-crud");t.initAddForm(e)})},cmg.core.services.LocationService.prototype.initAddForm=function(e){var t=document.getElementById(this.addTemplate).innerHTML,r=Handlebars.compile(t)({}),o=e.find(".cmt-location-form");o.hide(),o.html(r),cmt.api.utils.request.registerTargetApp("core",o),cmt.utils.ui.initSelectElement(o.find(".cmt-select")),o.find(".cmt-location-close").click(function(){o.fadeOut("fast")}),this.refreshGoogleMap(o),this.clearCity(o),o.fadeIn("slow")},cmg.core.services.LocationService.prototype.initUpdateForm=function(e,t,r){var o=document.getElementById(this.updateTemplate).innerHTML,i=Handlebars.compile(o)(r),c=e.find(".cmt-location-form");c.hide(),c.html(i),cmt.api.utils.request.registerTargetApp("core",c);var a=c.find(".cmt-location-country"),n=c.find(".cmt-location-province"),l=c.find(".cmt-location-region");a.val(a.attr("cid")),n.val(n.attr("pid")),1===l.length&&l.val(l.attr("rid")),c.find(".cmt-location-type").val(r.type),cmt.utils.ui.initSelectElement(c.find(".cmt-select")),c.find(".cmt-location-close").click(function(){c.fadeOut("fast")}),this.refreshGoogleMap(c),this.clearCity(c),c.fadeIn("slow"),this.refreshProvinces(c,n.attr("pid")),this.refreshRegions(c,l.attr("rid"))},cmg.core.services.LocationService.prototype.add=function(e,t){var r=document.getElementById(this.viewTemplate).innerHTML,o=Handlebars.compile(r)(t),i=e.find(".cmt-location-collection");i.prepend(o);var c=i.find(".cmt-location").first();cmt.api.utils.request.registerTargetApp("core",c),cmt.utils.ui.initActionsElement(c.find(".cmt-actions")),e.find(".cmt-location-form").slideUp("slow")},cmg.core.services.LocationService.prototype.refresh=function(e,t,r){var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.find(".cmt-location-header .title").html(r.title),t.find(".cmt-location-data").replaceWith(i),e.find(".cmt-location-form").slideUp("slow")},cmg.core.services.LocationService.prototype.remove=function(e,t){var r=t.find(".cmt-actions");if(0<r.length){var o=r.attr("ldata-id");jQuery("#actions-list-data-"+o).remove()}t.remove()},cmg.core.services.LocationService.prototype.findContainer=function(e){var t=e.closest(".cmt-location-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-location-crud")}}return t},cmg.core.services.LocationService.prototype.refreshProvinces=function(e,t){e.find(".cmt-location-country").attr("data-province",t),e.find(".cmt-location-country").closest(".cmt-location-countries").find(".cmt-click").trigger("click")},cmg.core.services.LocationService.prototype.refreshRegions=function(e,t){e.find(".cmt-location-province").attr("data-region",t),e.find(".cmt-location-province").closest(".cmt-location-provinces").find(".cmt-click").trigger("click")},cmg.core.services.LocationService.prototype.clearCity=function(e){e.find(".cmt-location-province, .cmt-location-region").change(function(){var e=jQuery(this).closest(".cmt-location").find(".cmt-location-city-fill");e.find(".target").val(""),e.find(".auto-fill-text").val("")})},cmg.core.services.LocationService.prototype.refreshGoogleMap=function(e){jQuery(e).find(".lat-long-picker").latLongPicker(),jQuery(e).find(".cmt-location-ll-picker .title, .cmt-location-ll-picker .line1, .cmt-location-ll-picker .line2, .cmt-location-ll-picker .line3, .cmt-location-ll-picker .city, .cmt-location-ll-picker .zip").keyup(function(){var e=jQuery(".cmt-location-ll-picker .title"),t="";0<e.length&&(t=e.val()),10<(t+=t+","+jQuery(".cmt-location-ll-picker .city").val()+","+jQuery(".cmt-location-ll-picker .zip").val()).length&&jQuery(".cmt-location-ll-picker .search-box").val(t).trigger("change")})},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapService("meta","cmg.core.services.MetaService"),e.getService("meta").initListeners()}),cmg.core.services.MetaService=function(){this.addTemplate="addMetaTemplate",this.updateTemplate="updateMetaTemplate",this.viewTemplate="metaViewTemplate",this.refreshTemplate="metaRefreshTemplate"},cmg.core.services.MetaService.inherits(cmt.api.services.BaseService),cmg.core.services.MetaService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-meta-crud");0!=e.length&&e.each(function(){var e=jQuery(this);switch(e.attr("ldata-layout")){case"popup":t.initPopups(e);break;default:e.find(".cmt-meta-add").click(function(){t.initAddForm(e)})}})},cmg.core.services.MetaService.prototype.initPopups=function(e){e.find(".cmt-meta-add").click(function(){showPopup("#popup-attribute-add"),cmt.utils.data.bindEditor("#popup-attribute-add .late-editor")}),this.initPopupTriggers(e.find(".cmt-meta"))},cmg.core.services.MetaService.prototype.initPopupTriggers=function(e){var t=this;e.find(".btn-edit").click(function(){showPopup("#popup-attribute-update"),t.copyData(jQuery(this).closest(".cmt-meta"),"#popup-attribute-update"),cmt.utils.data.bindEditor("#popup-attribute-update .late-editor")}),e.find(".btn-delete").click(function(){showPopup("#popup-attribute-delete"),t.copyData(jQuery(this).closest(".cmt-meta"),"#popup-attribute-delete"),cmt.utils.data.bindEditor("#popup-attribute-delete .late-editor")})},cmg.core.services.MetaService.prototype.initAddForm=function(e){var t=document.getElementById(this.addTemplate).innerHTML,r=Handlebars.compile(t)({}),o=e.find(".cmt-meta-form");o.hide(),o.html(r),cmt.api.utils.request.registerTargetApp("core",o),o.find(".cmt-meta-close").click(function(){o.fadeOut("fast")}),o.fadeIn("slow")},cmg.core.services.MetaService.prototype.initUpdateForm=function(e,t,r){var o=document.getElementById(this.updateTemplate).innerHTML,i=Handlebars.compile(o)(r),c=e.find(".cmt-meta-form");c.hide(),c.html(i),cmt.api.utils.request.registerTargetApp("core",c),c.find(".cmt-meta-close").click(function(){c.fadeOut("fast")}),c.fadeIn("slow")},cmg.core.services.MetaService.prototype.add=function(e,t){var r=document.getElementById(this.viewTemplate).innerHTML,o=Handlebars.compile(r)(t),i=e.find(".cmt-meta-collection"),c=e.attr("ldata-layout");i.prepend(o);var a=i.find(".cmt-meta").first();switch(c){case"popup":closePopup("#popup-attribute-add"),this.initPopupTriggers(a),a.find(".cscroller").mCustomScrollbar({autoHideScrollbar:!0});break;default:cmt.api.utils.request.registerTargetApp("core",a),cmt.utils.ui.initActionsElement(a.find(".cmt-actions")),e.find(".cmt-meta-form").slideUp("slow")}},cmg.core.services.MetaService.prototype.refresh=function(e,t,r){switch(e.attr("ldata-layout")){case"popup":t.find(".title").html(r.name),t.find(".cmt-meta-data .mCSB_container").html(r.value),closePopup("#popup-attribute-update");break;default:var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.find(".cmt-meta-header .title").html(r.title),t.find(".cmt-meta-data").replaceWith(i),e.find(".cmt-meta-form").slideUp("slow")}},cmg.core.services.MetaService.prototype.remove=function(e,t){var r=t.find(".cmt-actions");if(0<r.length){var o=r.attr("ldata-id");jQuery("#actions-list-data-"+o).remove()}switch(e.attr("ldata-layout")){case"popup":t.remove(),closePopup("#popup-attribute-delete");break;default:t.remove()}},cmg.core.services.MetaService.prototype.copyData=function(e,t){var r=e.attr("data-id"),o=e.find(".title").html(),i=e.find(".cmt-meta-data .mCSB_container").html(),c=jQuery(t).find("form");c.find(".name").val(o),c.find(".description").val(i),c.find(".message.success").val(),c.find(".message.error").val();var a=cmt.utils.data.updateUriParam(c.attr("action"),"cid",r);c.attr("action",a)},cmg.core.services.MetaService.prototype.findContainer=function(e){var t=e.closest(".cmt-meta-crud");if(0==t.length){var r=e.closest(".actions-list-data"),o=e.closest(".popup-content-wrap");if(1==r.length){var i=r.attr("ldata-id");t=jQuery("#actions-list-"+i).closest(".cmt-meta-crud")}if(1==o.length){var c=o.attr("data-id"),a=o.attr("data-type");t=jQuery(".cmt-meta-crud[data-id="+c+"][data-type="+a+"]")}}return t},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapService("model","cmg.core.services.ModelService"),e.getService("model").initListeners()}),cmg.core.services.ModelService=function(){this.addTemplate="addModelTemplate",this.updateTemplate="updateModelTemplate",this.viewTemplate="modelViewTemplate",this.refreshTemplate="modelRefreshTemplate"},cmg.core.services.ModelService.inherits(cmt.api.services.BaseService),cmg.core.services.ModelService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-model-add");0!=e.length&&e.click(function(){var e=jQuery(this).closest(".cmt-model-crud");t.initAddForm(e)})},cmg.core.services.ModelService.prototype.initAddForm=function(e){var t=document.getElementById(this.addTemplate).innerHTML,r=Handlebars.compile(t)({}),o=e.find(".cmt-model-form");o.hide(),o.html(r),cmt.api.utils.request.registerTargetApp("core",o),cmt.utils.ui.initSelectElement(o.find(".cmt-select")),o.find(".cmt-model-close").click(function(){o.fadeOut("fast")}),o.fadeIn("slow")},cmg.core.services.ModelService.prototype.initUpdateForm=function(e,t,r){var o=document.getElementById(this.updateTemplate).innerHTML,i=Handlebars.compile(o)(r),c=e.find(".cmt-model-form");c.hide(),c.html(i),cmt.api.utils.request.registerTargetApp("core",c),cmt.utils.ui.initSelectElement(c.find(".cmt-select")),c.find(".cmt-model-close").click(function(){c.fadeOut("fast")}),c.fadeIn("slow")},cmg.core.services.ModelService.prototype.add=function(e,t){var r=document.getElementById(this.viewTemplate).innerHTML,o=Handlebars.compile(r)(t),i=e.find(".cmt-model-collection");i.prepend(o);var c=i.find(".cmt-model").first();cmt.api.utils.request.registerTargetApp("core",c),cmt.utils.ui.initActionsElement(c.find(".cmt-actions")),e.find(".cmt-model-form").slideUp("slow")},cmg.core.services.ModelService.prototype.refresh=function(e,t,r){var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.find(".cmt-model-header .title").html(r.title),t.find(".cmt-model-data").replaceWith(i),e.find(".cmt-model-form").slideUp("slow")},cmg.core.services.ModelService.prototype.remove=function(e,t){var r=t.find(".cmt-actions");if(0<r.length){var o=r.attr("ldata-id");jQuery("#actions-list-data-"+o).remove()}t.remove()},cmg.core.services.ModelService.prototype.findContainer=function(e){var t=e.closest(".cmt-model-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-model-crud")}}return t},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("core");e.mapService("user","cmg.core.services.UserService"),e.getService("user").initListeners()}),cmg.core.services.UserService=function(){},cmg.core.services.UserService.inherits(cmt.api.services.BaseService),cmg.core.services.UserService.prototype.initListeners=function(){},jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("autoload","cmt.api.Application",{basePath:ajaxUrl});e.mapController("autoload","cmg.core.controllers.AutoloadController"),cmt.api.utils.request.register(e,jQuery("[cmt-app=autoload]"))}),cmg.core.controllers.AutoloadController=function(){},cmg.core.controllers.AutoloadController.inherits(cmt.api.controllers.RequestController),cmg.core.controllers.AutoloadController.prototype.autoloadActionSuccess=function(e,t){if(cmt.utils.object.hasProperty(t.data,"widgetId")&&cmt.utils.object.hasProperty(t.data,"widgetHtml")){var r=jQuery("#"+t.data.widgetId);0<r.length&&r.html(t.data.widgetHtml)}},document.addEventListener("DOMContentLoaded",initLazyWidgetObserver),jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("data","cmt.api.Application",{basePath:ajaxUrl});e.mapController("custom","cmg.data.controllers.CustomController"),e.mapService("custom","cmg.data.services.CustomService"),cmt.api.utils.request.register(e,jQuery("[cmt-app=data]")),e.getService("custom").initListeners()}),(cmg=cmg||{}).data=cmg.data||{},cmg.data.controllers=cmg.data.controllers||{},cmg.data.services=cmg.data.services||{},cmg.data.controllers.CustomController=function(){this.app=cmt.api.root.getApplication("data"),this.modelService=this.app.getService("custom")},cmg.data.controllers.CustomController.inherits(cmt.api.controllers.RequestController),cmg.data.controllers.CustomController.prototype.addActionPre=function(e){return this.requestForm=e.closest(".cmt-data-custom"),!0},cmg.data.controllers.CustomController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-data-custom");this.requestForm=null,this.modelService.refresh(r,o,t.data)},cmg.data.controllers.CustomController.prototype.updateActionPre=function(e){return this.requestForm=e.closest(".cmt-data-custom"),!0},cmg.data.controllers.CustomController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-data-custom");this.requestForm=null,this.modelService.refresh(r,o,t.data)},cmg.data.controllers.CustomController.prototype.deleteActionPre=function(e){return this.requestForm=e.closest(".cmt-data-custom"),!0},cmg.data.controllers.CustomController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-data-custom");this.requestForm=null,this.modelService.remove(r,o)},cmg.data.services.CustomService=function(){this.addTemplate="addCustomDataTemplate",this.refreshTemplate="refreshCustomDataTemplate"},cmg.data.services.CustomService.inherits(cmt.api.services.BaseService),cmg.data.services.CustomService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-data-custom-add");0!=e.length&&e.click(function(){var e=jQuery(this).closest(".cmt-data-custom-crud");t.initAddForm(e)})},cmg.data.services.CustomService.prototype.initAddForm=function(e){var t=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r=document.getElementById(this.addTemplate).innerHTML,o=Handlebars.compile(r)({key:t});e.find(".cmt-data-custom-collection").append(o);var i=e.find(".cmt-data-custom").last();cmt.api.utils.request.registerTargetApp("data",i),i.find(".btn-remove").click(function(){i.remove()})},cmg.data.services.CustomService.prototype.refresh=function(e,t,r){var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.html(i),cmt.api.utils.request.registerTargetApp("data",t)},cmg.data.services.CustomService.prototype.remove=function(e,t){var r=t.find(".cmt-actions");if(0<r.length){var o=r.attr("data-id");jQuery("#actions-list-data-"+o).remove()}t.remove()},cmg.data.services.CustomService.prototype.findContainer=function(e){var t=e.closest(".cmt-data-custom-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-data-custom-crud")}}return t},jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("gallery","cmt.api.Application",{basePath:ajaxUrl});e.mapController("item","cmg.controllers.gallery.ItemController"),e.mapService("item","cmg.services.gallery.ItemService"),cmt.api.utils.request.register(e,jQuery("[cmt-app=gallery]")),e.getService("item").initListeners()}),(cmg=cmg||{}).controllers=cmg.controllers||{},cmg.controllers.gallery=cmg.controllers.gallery||{},cmg.services=cmg.services||{},cmg.services.gallery=cmg.services.gallery||{},cmg.controllers.gallery.ItemController=function(){this.app=cmt.api.root.getApplication("gallery"),this.modelService=this.app.getService("item")},cmg.controllers.gallery.ItemController.inherits(cmt.api.controllers.RequestController),cmg.controllers.gallery.ItemController.prototype.getActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-gallery-item");e.closest(".actions-list-data").slideUp("fast"),this.modelService.initUpdateForm(r,o,t.data)},cmg.controllers.gallery.ItemController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e);this.modelService.add(r,t.data)},cmg.controllers.gallery.ItemController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-gallery-item[data-id="+t.data.mid+"]");this.modelService.refresh(r,o,t.data)},cmg.controllers.gallery.ItemController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=r.find(".cmt-gallery-item[data-id="+t.data.mid+"]");e.closest(".actions-list-data").slideUp("fast"),this.modelService.remove(r,o)},cmg.services.gallery.ItemService=function(){this.addTemplate="addItemTemplate",this.updateTemplate="updateItemTemplate",this.viewTemplate="itemViewTemplate",this.refreshTemplate="itemRefreshTemplate",this.hiddenForm=!0},cmg.services.gallery.ItemService.inherits(cmt.api.services.BaseService),cmg.services.gallery.ItemService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-gallery-item-add");0!=e.length&&e.click(function(){var e=jQuery(this).closest(".cmt-gallery-item-crud");t.initAddForm(e)})},cmg.services.gallery.ItemService.prototype.initAddForm=function(e){var t=document.getElementById(this.addTemplate).innerHTML,r=Handlebars.compile(t)({}),o=e.find(".cmt-gallery-item-form");o.hide(),o.html(r),cmt.api.utils.request.registerTargetApp("gallery",o),o.find(".cmt-gallery-item-uploader").cmtFileUploader(),o.find(".cmt-gallery-item-close").click(function(){o.fadeOut("fast")}),o.fadeIn("slow")},cmg.services.gallery.ItemService.prototype.initUpdateForm=function(e,t,r){var o=this,i=document.getElementById(this.updateTemplate).innerHTML,c=Handlebars.compile(i)(r),a=e.find(".cmt-gallery-item-form");a.hide(),a.html(c),cmt.api.utils.request.registerTargetApp("gallery",a),a.find(".file-data").html(t.find(".cmt-gallery-item-data").html()),a.find(".cmt-gallery-item-uploader").cmtFileUploader(),a.find(".cmt-gallery-item-close").click(function(){o.hiddenForm?a.fadeOut("fast"):o.initAddForm(e)}),a.fadeIn("slow")},cmg.services.gallery.ItemService.prototype.add=function(e,t){var r=document.getElementById(this.viewTemplate).innerHTML,o=Handlebars.compile(r)(t),i=e.find(".cmt-gallery-item-collection"),c=null;switch(cmt.utils.data.hasAttribute(e,"ldata-layout")?e.attr("ldata-layout"):null){case"cmt-gallery":i.cmtSlider("addSlide",o),c=i.find(".cmt-gallery-item[ldata-id=0]");break;default:i.prepend(o),c=i.find(".cmt-gallery-item").first()}cmt.api.utils.request.registerTargetApp("gallery",c),cmt.utils.ui.initActionsElement(c.find(".cmt-actions")),this.hiddenForm?e.find(".cmt-gallery-item-form").fadeOut("fast"):this.initAddForm(e)},cmg.services.gallery.ItemService.prototype.refresh=function(e,t,r){var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.find(".cmt-gallery-item-header .title").html(r.title),t.find(".cmt-gallery-item-data").replaceWith(i),this.hiddenForm?e.find(".cmt-gallery-item-form").fadeOut("fast"):this.initAddForm(e)},cmg.services.gallery.ItemService.prototype.remove=function(e,t){var r=t.find(".cmt-actions"),o=e.find(".cmt-gallery-item-collection"),i=cmt.utils.data.hasAttribute(e,"ldata-layout")?e.attr("ldata-layout"):null;if(0<r.length){var c=r.attr("ldata-id");jQuery("#actions-list-data-"+c).remove()}switch(i){case"cmt-gallery":o.cmtSlider("removeSlide",parseInt(t.attr("ldata-id")));break;default:t.remove()}},cmg.services.gallery.ItemService.prototype.findContainer=function(e){var t=e.closest(".cmt-gallery-item-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-gallery-item-crud")}}return t},jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("grid","cmt.api.Application",{basePath:ajaxUrl});e.mapController("crud","cmg.controllers.grid.CrudController"),cmt.api.utils.request.register(e,jQuery("[cmt-app=grid]"))}),(cmg=cmg||{}).controllers=cmg.controllers||{},cmg.controllers.grid=cmg.controllers.grid||{},cmg.services=cmg.services||{},cmg.services.grid=cmg.services.grid||{},cmg.controllers.grid.CrudController=function(){},cmg.controllers.grid.CrudController.inherits(cmt.api.controllers.RequestController),cmg.controllers.grid.CrudController.prototype.bulkActionSuccess=function(e,t){cmt.utils.data.refreshGrid()},cmg.controllers.grid.CrudController.prototype.bulkActionFailure=function(e,t){alert("Failed to process your request.")},cmg.controllers.grid.CrudController.prototype.genericActionSuccess=function(e,t){cmt.utils.data.refreshGrid()},cmg.controllers.grid.CrudController.prototype.genericActionFailure=function(e,t){alert("Failed to process your request.")},cmg.controllers.grid.CrudController.prototype.deleteActionSuccess=function(e,t){cmt.utils.data.refreshGrid()},cmg.controllers.grid.CrudController.prototype.deleteActionFailure=function(e,t){alert("Failed to process your request.")},jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("mapper","cmt.api.Application",{basePath:ajaxUrl});e.mapController("auto","cmg.controllers.mapper.AutoController"),e.mapController("model","cmg.controllers.mapper.ModelController"),e.mapController("csv","cmg.controllers.mapper.CsvController"),e.mapService("auto","cmg.services.mapper.AutoService"),cmt.api.utils.request.register(e,jQuery("[cmt-app=mapper]"))}),(cmg=cmg||{}).controllers=cmg.controllers||{},cmg.controllers.mapper=cmg.controllers.mapper||{},cmg.services=cmg.services||{},cmg.services.mapper=cmg.services.mapper||{},cmg.controllers.mapper.AutoController=function(){this.singleRequest=!0,this.previousLocation=null},cmg.controllers.mapper.AutoController.inherits(cmt.api.controllers.RequestController),cmg.controllers.mapper.AutoController.prototype.autoSearchActionPre=function(e){var t=e.closest(".auto-fill"),r=t.find(".search-name").val(),o=t.find(".search-type");return r.length<=0?(t.find(".auto-fill-items").slideUp(),t.find(".auto-fill-target .target").val(""),!1):(1==o.length?this.requestData="name="+r+"&type="+o.val():this.requestData="name="+r,!0)},cmg.controllers.mapper.AutoController.prototype.autoSearchActionSuccess=function(o,e){var t=e.data,r="",c=o.find(".auto-fill-items");for(i=0;i<t.length;i++){var a=t[i];r+="<li class='auto-fill-item' data-id='"+a.id+"'>"+a.name+"</li>"}0==r.length?(r="<li class='auto-fill-message'>No matching results found.</li>",c.html(r)):(c.html(r),o.find(".auto-fill-item").click(function(){var e=o.closest(".auto-fill").find(".auto-fill-target"),t=jQuery(this).attr("data-id"),r=jQuery(this).html();c.slideUp(),e.find(".target").val(t),o.find(".auto-fill-text").val(r)})),c.slideDown()},cmg.controllers.mapper.ModelController=function(){},cmg.controllers.mapper.ModelController.inherits(cmt.api.controllers.RequestController),cmg.controllers.mapper.ModelController.prototype.autoSearchActionPre=function(e){var t=e.closest(".auto-fill"),r=t.find("input[name=type]"),o=t.find(".auto-fill-text").val(),i=e.closest(".mapper-auto-items").find(".mapper-items").find(".mapper-item").length,c=e.closest(".mapper-auto-items").attr("limit");return o.length<=0?(t.find(".auto-fill-items").slideUp(),t.find(".trigger-map-item input[name=itemId]").val(""),!1):(null!==c&&parseInt(c)<=i&&alert("No more mappings allowed."),1==r.length?this.requestData="name="+o+"&type="+r.val():this.requestData="name="+o,!0)},cmg.controllers.mapper.ModelController.prototype.autoSearchActionSuccess=function(e,t){var r=t.data,o="",c=e.closest(".auto-fill"),a=e.find(".auto-fill-items"),n=e.attr("autoSubmit")||"yes",l=e.attr("template")||"";for(i=0;i<r.length;i++){var s=r[i];o+='<li class="auto-fill-item" data-id="'+s.id+'">'+s.name+"</li>"}0==o.length?(o='<li class="auto-fill-message">No matching results found.</li>',a.html(o)):(a.html(o),e.find(".auto-fill-item").click(function(){var e=jQuery(this).attr("data-id"),t=jQuery(this).html();a.slideUp(),"yes"===n?(c.find(".trigger-map-item input[name=itemId]").val(e),c.find(".trigger-map-item .cmt-click")[0].click()):cmt.api.root.getApplication("mapper").getService("auto").processAutoSearch(e,t,l)})),a.slideDown()},cmg.controllers.mapper.ModelController.prototype.mapItemActionPre=function(e){var t=e.find("input[name=itemId]").val();return 0<(t=parseInt(t))},cmg.controllers.mapper.ModelController.prototype.mapItemActionSuccess=function(e,t){var r=e.closest(".mapper-auto-items"),o=document.getElementById(r.attr("template")).innerHTML,i=Handlebars.compile(o),c=r.find(".mapper-items"),a=c.find(".mapper-item"),n=a.length,l=t.data.cid,s=t.data.name;r.find(".search-name").val("");for(var m=!0,d=0;d<n;d++){if(l==jQuery(a[d]).find(".cid").val()){m=!1;break}}if(m){var p=i({cid:l,name:s});c.append(p),n=(a=c.find(".mapper-item")).length,cmt.api.utils.request.register(cmt.api.root.getApplication("mapper"),a.last())}},cmg.controllers.mapper.ModelController.prototype.deleteItemActionSuccess=function(e,t){e.remove()},cmg.controllers.mapper.ModelController.prototype.toggleItemActionSuccess=function(e,t){},cmg.controllers.mapper.CsvController=function(){},cmg.controllers.mapper.CsvController.inherits(cmt.api.controllers.RequestController),cmg.controllers.mapper.CsvController.prototype.mapItemActionSuccess=function(e,t){var r=jQuery(".mapper-submit-items"),o=r.find(".mapper-items"),i=document.getElementById(r.attr("template")).innerHTML,c=Handlebars.compile(i)({list:t.data});o.html(c),cmt.api.utils.request.register(cmt.api.root.getApplication("mapper"),o.find("[cmt-app=mapper]"))},cmg.controllers.mapper.CsvController.prototype.deleteItemActionSuccess=function(e,t){e.remove()},cmg.services.mapper.AutoService=function(){},cmg.services.mapper.AutoService.inherits(cmt.api.services.BaseService),cmg.services.mapper.AutoService.prototype.processAutoSearch=function(e,t,r){var o=document.getElementById(r).innerHTML,i=(r=Handlebars.compile(o),jQuery(".mapper-auto-categories").find(".mapper-items")),c=i.find(".mapper-item"),a=c.length;if(jQuery(".mapper-auto-categories .search-name").val(""),5<=a)alert("No more mappings allowed.");else{for(var n=!0,l=0;l<a;l++){if(e==jQuery(c[l]).find(".id").val()){n=!1;break}}if(n){var s=r({id:e,name:t});i.append(s),a=(c=i.find(".mapper-item")).length,c.last().find(".mapper-item-remove").click(function(){jQuery(this).closest(".mapper-item").remove()})}}},jQuery(document).ready(function(){var e=cmt.api.root.getApplication("data");e.mapController("social","cmg.data.controllers.SocialController"),e.mapService("social","cmg.data.services.SocialService"),e.getService("social").initListeners()}),cmg.data.controllers.SocialController=function(){this.app=cmt.api.root.getApplication("data"),this.modelService=this.app.getService("social")},cmg.data.controllers.SocialController.inherits(cmt.api.controllers.RequestController),cmg.data.controllers.SocialController.prototype.addActionPre=function(e){return this.requestForm=e.closest(".cmt-data-social"),!0},cmg.data.controllers.SocialController.prototype.addActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-data-social");this.requestForm=null,this.modelService.refresh(r,o,t.data)},cmg.data.controllers.SocialController.prototype.updateActionPre=function(e){return this.requestForm=e.closest(".cmt-data-social"),!0},cmg.data.controllers.SocialController.prototype.updateActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-data-social");this.requestForm=null,this.modelService.refresh(r,o,t.data)},cmg.data.controllers.SocialController.prototype.deleteActionPre=function(e){return this.requestForm=e.closest(".cmt-data-social"),!0},cmg.data.controllers.SocialController.prototype.deleteActionSuccess=function(e,t){var r=this.modelService.findContainer(e),o=e.closest(".cmt-data-social");this.requestForm=null,this.modelService.remove(r,o)},cmg.data.services.SocialService=function(){this.addTemplate="addSocialDataTemplate",this.refreshTemplate="refreshSocialDataTemplate"},cmg.data.services.SocialService.inherits(cmt.api.services.BaseService),cmg.data.services.SocialService.prototype.initListeners=function(){var t=this,e=jQuery(".cmt-data-social-add");0!=e.length&&e.click(function(){var e=jQuery(this).closest(".cmt-data-social-crud");t.initAddForm(e)})},cmg.data.services.SocialService.prototype.initAddForm=function(e){var t=e.find(".cmt-data-social-options"),r=t.val(),o=t.find("option:selected").text(),i=document.getElementById(this.addTemplate).innerHTML,c=Handlebars.compile(i)({sns:o,icon:r});e.find(".cmt-data-social-collection").append(c);var a=e.find(".cmt-data-social").last();cmt.api.utils.request.registerTargetApp("data",a),a.find(".btn-remove").click(function(){a.remove()})},cmg.data.services.SocialService.prototype.refresh=function(e,t,r){var o=document.getElementById(this.refreshTemplate).innerHTML,i=Handlebars.compile(o)(r);t.html(i),cmt.api.utils.request.registerTargetApp("data",t)},cmg.data.services.SocialService.prototype.remove=function(e,t){var r=t.find(".cmt-actions");if(0<r.length){var o=r.attr("data-id");jQuery("#actions-list-data-"+o).remove()}t.remove()},cmg.data.services.SocialService.prototype.findContainer=function(e){var t=e.closest(".cmt-data-social-crud");if(0==t.length){var r=e.closest(".actions-list-data");if(1==r.length){var o=r.attr("ldata-id");t=jQuery("#actions-list-"+o).closest(".cmt-data-social-crud")}}return t},jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("forms","cmt.api.Application",{basePath:ajaxUrl});cmt.api.utils.request.register(e,jQuery("[cmt-app=forms]"))}),(cmg=cmg||{}).forms=cmg.forms||{},cmg.forms.controllers=cmg.forms.controllers||{},cmg.forms.services=cmg.forms.services||{},jQuery(document).ready(function(){cmt.api.root.getApplication("forms").mapController("form","cmg.forms.controllers.FormController")}),cmg.forms.controllers.FormController=function(){},cmg.forms.controllers.FormController.inherits(cmt.api.controllers.RequestController),cmg.forms.controllers.FormController.prototype.defaultActionSuccess=function(e,t){console.log("form processed successfully.")},cmg.forms.controllers.FormController.prototype.defaultActionFailure=function(e,t){console.log("form processing failed.")},jQuery(document).ready(function(){var e=cmt.api.root.registerApplication("notify","cmt.api.Application",{basePath:ajaxUrl});cmt.api.utils.request.register(e,jQuery("[cmt-app=notify]"))}),(cmg=cmg||{}).notify=cmg.notify||{},cmg.notify.controllers=cmg.notify.controllers||{},cmg.notify.services=cmg.notify.services||{},jQuery(document).ready(function(){cmt.api.root.getApplication("notify").mapController("notification","cmg.notify.controllers.NotificationController"),0<jQuery("[cmt-app=notify]").length&&cmt.api.utils.request.triggerDirect(cmt.api.root.getApplication("notify"),"notification","stats","notify/stats/stats","get"),jQuery(document.body).append(jQuery("#notificationData").detach()),jQuery(document.body).append(jQuery("#reminderData").detach()),jQuery(document.body).append(jQuery("#activityData").detach()),jQuery(document.body).append(jQuery("#announcementData").detach())}),cmg.notify.controllers.NotificationController=function(){},cmg.notify.controllers.NotificationController.inherits(cmt.api.controllers.BaseController),cmg.notify.controllers.NotificationController.prototype.toggleReadActionSuccess=function(e,t){location.reload(!0)},cmg.notify.controllers.NotificationController.prototype.readActionSuccess=function(e,t){e.is("[redirect]")?window.location=e.attr("redirect"):location.reload(!0)},cmg.notify.controllers.NotificationController.prototype.hreadActionSuccess=function(e,t){var r=e.find(".cmt-click").attr("type"),o=t.data.unread;t.data.consumed&&(jQuery(".count-header.count-"+r).html(o),jQuery(".count-sidebar.count-sidebar-header.count-"+r).html(o),jQuery(".count-sidebar.count-sidebar-content.count-"+r).html(o),0==o&&(jQuery(".count-header.count-"+r).fadeOut("fast"),jQuery(".count-sidebar.count-sidebar-header.count-"+r).fadeOut("fast"),jQuery(".count-sidebar.count-sidebar-content.count-"+r).fadeOut("fast"))),e.is("[redirect]")&&(window.location=e.attr("redirect"))},cmg.notify.controllers.NotificationController.prototype.toggleTrashActionSuccess=function(e,t){location.reload(!0)},cmg.notify.controllers.NotificationController.prototype.trashActionSuccess=function(e,t){location.reload(!0)},cmg.notify.controllers.NotificationController.prototype.deleteActionSuccess=function(e,t){location.reload(!0)},cmg.notify.controllers.NotificationController.prototype.statsActionSuccess=function(e){var t=e.data;t.hasOwnProperty("notificationCount")&&jQuery(".count-notification").html(t.notificationCount),t.hasOwnProperty("remonderCount")&&jQuery(".count-reminder").html(t.remonderCount),t.hasOwnProperty("activityCount")&&jQuery(".count-activity").html(t.activityCount),t.hasOwnProperty("announcementCount")&&jQuery(".count-announcement").html(t.announcementCount)},cmg.notify.controllers.NotificationController.prototype.notificationDataActionSuccess=function(e,t){var r=t.data,o=document.getElementById("notificationData").innerHTML;if(r.hasOwnProperty("notifications")){var i="",c=Handlebars.compile(o);jQuery.each(r.notifications,function(e,t){i+=c({data:t,siteUrl:siteUrl})}),0<r.notifications.length?i+="<li class='align align-center'><a href='"+siteUrl+"notify/notification/all'>View All</a></li>":i="Notifications not found.",i="<ul>"+i+"</ul>",jQuery("#popout-notification").find(".popout-content").html(i),cmt.api.utils.request.register(cmt.api.root.getApplication("notify"),jQuery("#popout-notification").find("[cmt-app=notify]"))}},cmg.notify.controllers.NotificationController.prototype.reminderDataActionSuccess=function(e,t){var r=t.data,o=document.getElementById("reminderData").innerHTML;if(r.hasOwnProperty("reminders")){var i="",c=Handlebars.compile(o);jQuery.each(r.reminders,function(e,t){i+=c({data:t,siteUrl:siteUrl})}),0<r.reminders.length?i+="<li class='align align-center'><a href='"+siteUrl+"notify/reminder/all'>View All</a></li>":i="Reminders not found.",i="<ul>"+i+"</ul>",jQuery("#popout-reminder").find(".popout-content").html(i),cmt.api.utils.request.register(cmt.api.root.getApplication("notify"),jQuery("#popout-reminder").find("[cmt-app=notify]"))}},cmg.notify.controllers.NotificationController.prototype.activityDataActionSuccess=function(e,t){var r=t.data,o=document.getElementById("activityData").innerHTML;if(r.hasOwnProperty("activities")){var i="",c=Handlebars.compile(o);jQuery.each(r.activities,function(e,t){i+=c({data:t,siteUrl:siteUrl})}),0<r.activities.length?i+="<li class='align align-center'><a href='"+siteUrl+"notify/activity/all'>View All</a></li>":i="Activites not found.",i="<ul>"+i+"</ul>",jQuery("#popout-activity").find(".popout-content").html(i),cmt.api.utils.request.register(cmt.api.root.getApplication("notify"),jQuery("#popout-activity").find("[cmt-app=notify]"))}},cmg.notify.controllers.NotificationController.prototype.announcementDataActionSuccess=function(e,t){var r=t.data,o=document.getElementById("announcementData").innerHTML;if(r.hasOwnProperty("announcements")){var i="",c=Handlebars.compile(o);jQuery.each(r.announcements,function(e,t){i+=c({data:t,siteUrl:siteUrl})}),0<r.activities.length?i+="<li class='align align-center'><a href='"+siteUrl+"notify/announcement/all'>View All</a></li>":i="Announcements not found.",i="<ul>"+i+"</ul>",jQuery("#popout-announcement").find(".popout-content").html(i),cmt.api.utils.request.register(cmt.api.root.getApplication("notify"),jQuery("#popout-announcement").find("[cmt-app=notify]"))}};